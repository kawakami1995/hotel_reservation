<header>
    <headerContain>
        <a href="/" class="header_logo_area"><img src="https://rails-02-sample.herokuapp.com/assets/common/logo.png" alt="ヘッダーロゴ" class="header_image"> </a>
        <div class="headerButtons">
            <% if user_signed_in? %>
                <% if @user.user_image.blank? %>
                    <%= image_tag "default_user.png", class: "top_user_image" %>
                <% else %>
                    <img src=<%= @user.user_image %>class="top_user_image"><br>   
                <% end %>                                 
                <div class="headerButton account_setting">
                    <div class="dropdown_btn">
                        <div id="user_name">
                            <p class=""><%= @user.user_name %></p>
                            <p class="triangle">▼</p>     
                        </div>             
                    </div>   
                    <ul id="dropdown_list">
                        <li class="dropdown_item"><a href="/rooms/new">施設の新規登録</a></li>
                        <li class="dropdown_item"><a href="/reservations/index">予約済み一覧</a></li>
                        <li class="dropdown_item"><a href="/rooms/index">登録済み一覧</a></li>
                        <li class="dropdown_item"><a href="/users/account">アカウント設定</a></li>
                        <li class="dropdown_item"><a href="/users/sign_out">ログアウト</a></li>
                    </ul>
                </div>              
            <% else %>
                <div class="headerButton login">
                    <%= link_to "ログイン","/users/sign_in" %>
                </div>
                <div class="headerButton newAccount">
                    <%= link_to "新規登録","/users/sign_up" %>
                </div>       
            <% end %>       
        </div>
    </headerContain>
</header>
<h3>部屋詳細</h3>
<%= form_with  model: Reservation.new ,url: reservations_confirm_path, html: {multipart: true} ,method: :get,local: true do |f| %>  
    <div class="field room_detail">
        <td>
            <% if @room.room_image.blank? %>
                <%= image_tag "default_room.png" %>
            <% else %>
                <img src=<%= @room.room_image %>><br>   
            <% end %>       
        </td>
    </div>
    <div class="room_information">
        <div class="field">
            <td><%= @room.room_name %></td>
            <td><%= f.hidden_field :room_name,value: @room.room_name %></td>
        </div>
        <div class="field"> 
            <td><%= @room.address %></td>
            <td><%= f.hidden_field :address,value: @room.address %></td>
        </div>
        <div class="field">
            <td><%= f.label :"¥#{@room.price.to_s(:delimited, delimiter: ',')}" %></td>
            <td><%= f.hidden_field :price,value: @room.price %></td>
        </div>
        <div class="field">
            <td><%= @room.room_introduction %></td>
            <td><%= f.hidden_field :room_introduction,value: @room.room_introduction %></td>
        </div>
        <div class="field">
            <td><%= f.label :チェックイン %></td><p class="caution">※必須</p><br> 
            <td><%= f.date_field :check_in_date,value: @reservation.check_in_date , required: true %></td>
            <p class="caution"><%= @check_in_date_caution %></p>
        </div>
        <div class="field">
            <td><%= f.label :チェックアウト %></td><p class="caution">※必須</p><br> 
            <td><%= f.date_field :check_out_date,value: @reservation.check_out_date , required: true %></td>
            <p class="caution"><%= @check_out_date_caution %></p>
        </div>
        <div class="field">
            <td><%= f.label :人数 %></td><p class="caution">※必須</p><br> 
            <td><%= f.number_field :number_of_people,value: @reservation.number_of_people , required: true %></td>
        </div>
        <div class="field">       
            <%= f.hidden_field :user_id,value: @user.id %> 
            <% if @room.id %>
                <%= f.hidden_field :room_id,value: @room.id %> 
            <% elsif @room.room_id %>
                <%= f.hidden_field :room_id,value: @room.room_id %> 
            <%  end %>
        </div>
        <div class="field">
            <%= f.submit "予約する", class: "submit_button"%>
            <%= link_to "戻る", :back %>
        </div>
    </div>
<% end %>
<!-- Javascriptの外部ファイルが読み込めなかったため、やむを得ず直接記載しています。 -->
<script type="text/javascript">
    document.getElementById("dropdown_list").style.visibility = "hidden"
    document.addEventListener("click", (e) => {        
        if(!e.target.closest("#user_name")) {
            document.getElementById("dropdown_list").style.visibility = "hidden"
        } else {
            document.getElementById("dropdown_list").style.visibility = "visible"
        }
      })
</script>



   